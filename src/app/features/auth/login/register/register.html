<div class="page">
  <div class="card">
    <h2>Créer un compte</h2>
    <p class="subtitle">Inscription utilisateur.</p>

    <div *ngIf="errorMessage" class="alert alert-danger">
  {{ errorMessage }}
</div>


    <form #f="ngForm" (ngSubmit)="onSubmit()">

      <div class="form-group">
        <label>Username</label>
        <input name="username" [(ngModel)]="username" required [disabled]="loading" #u="ngModel" />
        <div class="field-error" *ngIf="(f.submitted || u.touched) && u.invalid">
          Username obligatoire.
        </div>
      </div>

      <div class="form-group">
        <label>Email (optionnel)</label>
        <input name="email" [(ngModel)]="email" [disabled]="loading" />
      </div>

      <div class="form-group">
        <label>Mot de passe</label>
        <input type="password" name="password" [(ngModel)]="password" required minlength="6" [disabled]="loading" #p="ngModel" />
        <div class="field-error" *ngIf="(f.submitted || p.touched) && p.invalid">
          <span *ngIf="p.errors?.['required']">Mot de passe obligatoire.</span>
          <span *ngIf="p.errors?.['minlength']">Minimum 6 caractères.</span>
        </div>
      </div>

      <div class="form-group">
        <label>Confirmer le mot de passe</label>
        <input type="password" name="confirmPassword" [(ngModel)]="confirmPassword" required [disabled]="loading" #cp="ngModel" />
        <div class="field-error" *ngIf="(f.submitted || cp.touched) && cp.invalid">
          Confirmation obligatoire.
        </div>
      </div>

      <button class="btn btn-primary" type="submit" [disabled]="loading || f.invalid">
        {{ loading ? 'Création...' : 'Créer mon compte' }}
      </button>
    </form>

    <p style="margin-top: 12px;">
      Déjà un compte ?
      <a routerLink="/login">Se connecter</a>
    </p>
  </div>
</div>
